<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Comparison: asreml and H2cal"><title>Stagewise mixed-model analysis • inti</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png"><script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Stagewise mixed-model analysis"><meta property="og:description" content="Comparison: asreml and H2cal"><meta property="og:image" content="https://inkaverse.com/reference/figures/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-804H2EJ8RN"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-804H2EJ8RN');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">inti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../articles/apps.html">
    <span class="fa fa-gamepad fa-lg"></span>
     
    Apps
  </a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fa fa-book fa-lg"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../../articles/tarpuy.html">Tarpuy: field-book experimental plans</a>
    <a class="dropdown-item" href="../../articles/yupana.html">Yupana: experimental design analysis</a>
    <a class="dropdown-item" href="../../articles/extra/yupana-coding.html">Yupana: coding workflow</a>
    <a class="dropdown-item" href="../../articles/rticles.html">Rticles: scientific documents with R</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/heritability.html">Broad-sense heritability in plant breeding</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../articles/policy.html">
    <span class="fa fa-shield-alt fa-lg"></span>
     
    Privacy Policy
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">
    <span class="fa fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">
    <span class="fa fa-file-alt fa-lg"></span>
     
    News
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/flavjack/inti/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sponsors/Flavjack">
    <span class="fas fa fas fa-heart fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-article">



<script src="stagewise_files/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="stagewise_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="stagewise_files/datatables-binding-0.23/datatables.js"></script>
<link href="stagewise_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="stagewise_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="stagewise_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<script src="stagewise_files/jszip-1.11.3/jszip.min.js"></script>
<link href="stagewise_files/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="stagewise_files/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js"></script>
<script src="stagewise_files/dt-ext-buttons-1.11.3/js/buttons.html5.min.js"></script>
<script src="stagewise_files/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js"></script>
<script src="stagewise_files/dt-ext-buttons-1.11.3/js/buttons.print.min.js"></script>
<link href="stagewise_files/dt-ext-scroller-1.11.3/css/scroller.dataTables.min.css" rel="stylesheet" />
<script src="stagewise_files/dt-ext-scroller-1.11.3/js/dataTables.scroller.min.js"></script>
<link href="stagewise_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="stagewise_files/crosstalk-1.2.0/js/crosstalk.min.js"></script>

<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Stagewise mixed-model analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/flavjack/inti/blob/HEAD/vignettes/extra/stagewise.Rmd" class="external-link"><code>vignettes/extra/stagewise.Rmd</code></a></small>
      <div class="d-none name"><code>stagewise.Rmd</code></div>
    </div>

    
    
<p>Best Linear Unbiased Predictors (BLUP) is used in plant breeding
experiments for the selection of the best lines in multi-environmental
trials (MET).</p>
<p>In this section, a comparison will be made between the
<code>H2Cal()</code> function of the inti package <span
class="citation">(<a href="#ref-R-inti"
role="doc-biblioref">Lozano-Isla, 2020</a>)</span> and the code using
the <code>asrml</code> package published by <span
class="citation">Buntaran et al. (<a href="#ref-buntaran2020Cross"
role="doc-biblioref">2020</a>)</span>.</p>
<p>For the comparison we will use the two methods described by <span
class="citation">Buntaran et al. (<a href="#ref-buntaran2020Cross"
role="doc-biblioref">2020</a>)</span>. (i) The “two-stage” analysis,
using two stages, the first to calculate the BLUEs and the second the
BLUPs. (ii) The “one stage” analysis using only one model to calculate
the BLUPs.</p>
<div id="load-data" class="section level1">
<h1>Load data</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inti)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>fb <span class="ot">&lt;-</span> inti<span class="sc">::</span>met</span></code></pre></div>
</div>
<div id="two-stage-analysis" class="section level1">
<h1>Two-stage analysis</h1>
<div id="asreml" class="section level2">
<h2>asreml</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(asreml)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">asreml.options</span>(<span class="at">maxit=</span><span class="dv">100</span>) <span class="co"># Set asreml iteration</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">##### Stage I LSMEANS #####</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="do">##### per location   #####</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>ww <span class="ot">&lt;-</span> <span class="fu">data.table</span>(fb)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="do">##### Make column Zone_Loc #####</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>trials     <span class="ot">&lt;-</span> <span class="fu">nlevels</span>(ww<span class="sc">$</span>env)</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>envs <span class="ot">&lt;-</span> <span class="fu">levels</span>(ww<span class="sc">$</span>env)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="do">##### Make data list for Stage I #####</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">list</span>(), <span class="at">nrow=</span><span class="fu">length</span>(envs), <span class="at">ncol=</span><span class="dv">1</span>, </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dimnames=</span><span class="fu">list</span>(envs, <span class="fu">c</span>(<span class="st">&quot;data_Set&quot;</span>)))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="do">##### Make a list of Trials #####</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>trials){</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">levels</span>(ww<span class="sc">$</span>env)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  c <span class="ot">&lt;-</span> b[i]</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  env <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(c)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  env <span class="ot">&lt;-</span> <span class="fu">data.table</span>(env)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">merge</span>(ww,env,<span class="at">by=</span><span class="st">&quot;env&quot;</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">paste0</span>(<span class="st">&quot;data_&quot;</span>, b[i]), f)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  data_list[[i, <span class="st">&quot;data_Set&quot;</span> ]] <span class="ot">&lt;-</span> f</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(b, c, f, env)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>data_list <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="fu">ldply</span>(data_list[, <span class="st">&quot;data_Set&quot;</span>], data.frame, <span class="at">.id=</span><span class="st">&quot;env&quot;</span>))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>stgI_list <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data=</span><span class="fu">list</span>(), <span class="at">nrow=</span><span class="fu">length</span>(envs), <span class="at">ncol=</span><span class="dv">1</span>, </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>                    <span class="at">dimnames=</span><span class="fu">list</span>(envs, <span class="fu">c</span>(<span class="st">&quot;lsmeans&quot;</span>)))</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a><span class="fu">asreml.options</span>(<span class="at">maxit=</span><span class="dv">100</span>) <span class="co"># Set asreml iteration</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a><span class="do">##### Stage I LSMEANS #####</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a><span class="do">##### per location   #####</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> envs){</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>  edat <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(<span class="fu">subset</span>(ww, env <span class="sc">==</span> i))</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(i)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  mod<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">asreml</span>(<span class="at">fixed     =</span> yield <span class="sc">~</span> cultivar,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>                  <span class="at">random      =</span> <span class="sc">~</span> rep <span class="sc">+</span> rep<span class="sc">:</span>alpha,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data        =</span> edat,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>                  <span class="at">predict     =</span> <span class="fu">predict.asreml</span>(<span class="at">classify =</span> <span class="st">&quot;cultivar&quot;</span>))</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update.asreml</span>(mod<span class="fl">.1</span>)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary.asreml</span>(mod<span class="fl">.1</span>)<span class="sc">$</span>varcomp)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>  blue <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod<span class="fl">.1</span>, <span class="at">classify=</span><span class="st">&quot;cultivar&quot;</span>, <span class="at">levels=</span><span class="fu">levels</span>(edat<span class="sc">$</span>cultivar), <span class="at">vcov=</span><span class="cn">TRUE</span>,<span class="at">aliased =</span> T) <span class="co"># get the lsmeans</span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>  blue<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">data.table</span>(blue<span class="sc">$</span>pvals)[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)] </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(blue<span class="fl">.1</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;cultivar&quot;</span>, <span class="st">&quot;yield_lsm&quot;</span>, <span class="st">&quot;se&quot;</span>)</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  blue<span class="fl">.1</span>[ , <span class="st">&#39;:=&#39;</span>(<span class="at">var=</span>se<span class="sc">^</span><span class="dv">2</span>, <span class="at">smith.w=</span><span class="fu">diag</span>(<span class="fu">solve</span>(blue<span class="sc">$</span>vcov)))] <span class="co"># calculate the Smith&#39;s weight</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  stgI_list[[i, <span class="st">&quot;lsmeans&quot;</span> ]] <span class="ot">&lt;-</span> blue<span class="fl">.1</span> <span class="co"># put all the results of Stage 1 in the list</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rm</span>(Edat,mod<span class="fl">.1</span>, blue, blue<span class="fl">.1</span>)</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="do">#######################################################</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="do">##### Preparing dataset of Stage I for Stage II ######</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a><span class="do">##### Unlist the results of Stage I and format as data.table #####</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>stgII_list <span class="ot">&lt;-</span> <span class="fu">data.table</span>(plyr<span class="sc">::</span><span class="fu">ldply</span>(stgI_list[, <span class="st">&quot;lsmeans&quot;</span>], data.frame, <span class="at">.id=</span><span class="st">&quot;env&quot;</span>))</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>stgII_list<span class="sc">$</span>zone<span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">str_split_fixed</span>(stgII_list<span class="sc">$</span>env, <span class="st">&quot;_&quot;</span>, <span class="dv">2</span>)[,<span class="dv">1</span>]) <span class="co"># Make Zone column by split the record in Zone_Loc column</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>stgII_list<span class="sc">$</span>location <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">str_split_fixed</span>(stgII_list<span class="sc">$</span>env, <span class="st">&quot;_&quot;</span>, <span class="dv">3</span>)[,<span class="dv">2</span>])  <span class="co"># Make Location by split the record in Zone_Loc column</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>stgII_list<span class="sc">$</span>year <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">str_split_fixed</span>(stgII_list<span class="sc">$</span>env, <span class="st">&quot;_&quot;</span>, <span class="dv">3</span>)[,<span class="dv">3</span>]) <span class="co"># Make Year by split the record in Zone_Loc column</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>blues.asreml <span class="ot">&lt;-</span> stgII_list</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="do">############################</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a><span class="do">##### Stage II BLUPs ######</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a><span class="do">##### Zone analysis #####</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">asreml</span>(yield_lsm  <span class="sc">~</span> zone,</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>                <span class="at">random    =</span> <span class="sc">~</span>cultivar <span class="sc">+</span> zone<span class="sc">:</span>location <span class="sc">+</span> zone<span class="sc">:</span>cultivar <span class="sc">+</span> cultivar<span class="sc">:</span>zone<span class="sc">:</span>location,</span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>                <span class="at">weights   =</span> smith.w,</span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>                <span class="at">family    =</span> <span class="fu">asr_gaussian</span>(<span class="at">dispersion=</span><span class="fl">1.0</span>), <span class="co"># fix residual variance to 1</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>                <span class="at">data      =</span> blues.asreml,</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">predict   =</span> <span class="fu">predict.asreml</span>(<span class="at">classify =</span> <span class="st">&quot;cultivar&quot;</span>)</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a><span class="fu">update.asreml</span>(model)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="co"># print(summary.asreml(model)$varcomp) # print the variance components</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>blups.asrml <span class="ot">&lt;-</span> <span class="fu">data.frame</span>((model<span class="sc">$</span>predictions<span class="sc">$</span>pvals[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]))</span></code></pre></div>
</div>
<div id="h2cal" class="section level2">
<h2>H2cal</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inti)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; First stage</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>envs <span class="ot">&lt;-</span> <span class="fu">levels</span>(fb<span class="sc">$</span>env)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(envs) <span class="sc">%&gt;%</span> <span class="fu">map</span>(<span class="cf">function</span>(x) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> fb <span class="sc">%&gt;%</span> <span class="fu">filter</span>(env <span class="sc">%in%</span> envs[x]) <span class="sc">%&gt;%</span> </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">H2cal</span>(<span class="at">trait =</span> <span class="st">&quot;yield&quot;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>          , <span class="at">gen.name =</span> <span class="st">&quot;cultivar&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>          , <span class="at">rep.n =</span> <span class="dv">4</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>          , <span class="at">fixed.model =</span> <span class="st">&quot;0 + (1|rep) + (1|rep:alpha) + cultivar&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>          , <span class="at">random.model =</span> <span class="st">&quot;1 + (1|rep) + (1|rep:alpha) + (1|cultivar)&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>          <span class="co"># , plot_diag = T</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>          , <span class="at">emmeans =</span> F</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  blues <span class="ot">&lt;-</span> model<span class="sc">$</span>blues <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">trial =</span> <span class="fu">levels</span>(fb<span class="sc">$</span>env)[x])</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>blues.h2cal <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(trial, <span class="fu">c</span>(<span class="st">&quot;zone&quot;</span>, <span class="st">&quot;location&quot;</span>, <span class="st">&quot;year&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(yield, smith.w), as.numeric)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span><span class="fu">c</span>(yield, smith.w), as.factor))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Second stage</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>met <span class="ot">&lt;-</span> blues.h2cal <span class="sc">%&gt;%</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span>yield, as.factor)) <span class="sc">%&gt;%</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">H2cal</span>(<span class="at">trait =</span> <span class="st">&quot;yield&quot;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>        , <span class="at">gen.name =</span> <span class="st">&quot;cultivar&quot;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>        , <span class="at">rep.n =</span> <span class="dv">4</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>        , <span class="at">env.n =</span> <span class="dv">18</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        , <span class="at">env.name =</span> <span class="st">&quot;location&quot;</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>        , <span class="at">fixed.model =</span> <span class="st">&quot;0 + zone + (1|zone:location) + (1|zone:cultivar) + cultivar&quot;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>        , <span class="at">random.model =</span> <span class="st">&quot;1 + zone + (1|zone:location) + (1|zone:cultivar) + (1|cultivar)&quot;</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># , plot_diag = T</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>        , <span class="at">emmeans =</span> T</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>        <span class="co"># , weights = blues.h2cal$smith.w</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>blups.h2cal <span class="ot">&lt;-</span> met<span class="sc">$</span>blups</span></code></pre></div>
<ul>
<li>First stage
<ul>
<li>Fixed model with <code>0 +</code> for avoid intercep and calculate
all the BLUEs.</li>
<li><code>emmeans = F</code> to calculate the Smith weitghts in the
first stage</li>
</ul></li>
</ul>
</div>
<div id="blues-comparison" class="section level2">
<h2>BLUEs comparison</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>blues.comp <span class="ot">&lt;-</span> <span class="fu">merge</span>(blues.asreml </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                    , blues.h2cal </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;cultivar&quot;</span>, <span class="st">&quot;zone&quot;</span>, <span class="st">&quot;location&quot;</span>))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(blues.comp$yield, blues.comp$yield_lsm)</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">cor</span>(blues.comp<span class="sc">$</span>yield, blues.comp<span class="sc">$</span>yield_lsm) </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;r =&quot;</span>, rs)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="do">## r = 1</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>blues.comp <span class="sc">%&gt;%</span> <span class="fu">web_table</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-97a004fe59f9a0506461" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-97a004fe59f9a0506461">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","Scroller"],"data":[["22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954"],["middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south"],["07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35"],[1053.8867,676.7814,392.8929,996.9302,594.2476,507.974,1139.6655,579.7078,934.1587,946.9406,774.4448,865.6055,726.9123,983.6488,804.7414,845.6318,709.3489,775.3109,1027.1622,722.1601,503.1301,1025.1892,633.6131,517.7712,1108.7641,571.7162,987.229,950.0426,766.5155,905.1625,816.2493,1097.7538,866.4721,910.6445,638.3879,725.5896,1009.4218,633.6128,332.5626,1014.2059,539.3671,472.3368,1195.5875,564.4037,1016.252,879.7536,718.4646,907.8125,812.6835,1061.9315,796.2178,892.8501,562.6414,827.8594,1089.2723,704.0956,304.5675,1089.4772,653.1072,592.0598,1304.2087,664.9833,1068.0228,1009.6937,851.6733,903.7414,890.8349,1163.2533,970.1844,895.9256,506.1368,734.3033,1090.5304,739.3209,592.466,1089.5642,685.9182,559.4916,1185.9003,575.5621,1038.3792,997.5589,791.2077,957.1595,859.4897,1111.9505,910.5981,943.0544,749.5163,867.4415,1150.692,656.4584,449.8178,1049.6715,627.7268,503.8572,1233.2753,677.2698,1035.6365,954.2988,778.0865,1006.6036,805.4828,1121.5267,988.3123,937.2278,632.4238,779.1072,1097.3551,671.4843,579.4652,1028.5792,646.8271,550.6783,1176.4371,660.954,992.6642,934.4613,742.5032,911.099,827.1972,1078.6084,895.919,914.6187,652.5142,803.8281,1103.081,718.0598,460.6553,1032.5355,594.6389,518.6391,1259.6865,562.2456,996.2633,961.2831,800.4131,937.8475,853.6626,1052.7072,971.0863,866.2121,544.0553,793.7977,922.5899,709.4097,386.7818,1050.5679,575.0502,497.1411,1221.5307,643.6717,947.0956,740.8071,1006.5718,903.6079,1181.402,918.3689,909.1477,574.101,815.8749,1054.3164,755.8814,480.8976,1067.3788,621.0092,559.114,1169.668,626.7982,1039.1057,967.0675,838.0475,929.3435,848.5631,1105.3719,898.0506,930.8744,689.1034,864.3326,999.1097,715.1168,438.6576,1046.7004,628.2988,558.4185,1224.9926,593.9752,959.6689,917.2466,806.2453,932.49,858.1893,1094.3399,876.9082,957.78,444.9161,864.0288,1023.8673,719.3739,468.7252,1098.907,674.5178,654.5294,1243.4191,630.2589,1023.8723,967.954,758.7308,900.8072,832.2856,1138.0755,934.3942,942.6088,705.7516,892.0426,1072.3373,699.61,470.4842,1027.1579,698.4183,629.3681,1232.3287,646.5887,1057.6889,1005.6961,841.3199,966.6152,897.6809,1037.5935,970.5648,964.3123,648.8251,871.7005,1073.4953,686.8036,396.0211,1063.6929,661.0611,535.0826,1256.421,634.8302,1014.3765,985.3576,808.9862,883.3932,843.6963,1106.632,928.884,971.419,623.1526,840.1952,1114.3559,754.0145,478.112,1060.6085,653.4129,572.2138,1085.964,605.1138,1012.4136,946.0043,821.4094,899.4806,881.3316,1086.2169,908.6311,903.3283,806.5929,904.2089,1043.8328,759.2008,573.3388,1050.4746,643.7286,558.6211,1188.099,614.9631,1014.219,948.3734,739.0545,940.6905,820.2823,1047.632,875.6889,887.6357,730.6119,871.6726,1150.1793,656.1881,480.9883,1051.9555,576.9628,473.1233,1168.02,607.3712,967.1922,915.9611,771.8106,920.09,825.1822,1035.035,901.5656,899.1311,712.5504,897.6361,1120.4837,703.452,497.2201,1058.9769,601.5671,508.4099,1207.8246,650.7281,1039.6131,940.2251,737.8518,934.756,854.0733,1072.9639,973.1298,921.5245,695.5008,881.1882,1042.1306,719.8604,514.9874,1018.1299,679.0851,552.6704,1192.4877,582.8249,1003.7864,984.3321,768.4423,877.6816,869.2047,1076.9676,846.2381,918.5616,640.8117,789.0549,1070.5161,738.2939,493.378,1004.628,614.643,614.8886,1191.4263,642.8286,996.8887,982.9421,801.407,920.3538,885.6998,1058.0462,886.8597,951.0664,767.8935,877.0625,1073.8058,778.2273,602.2978,1078.9502,658.6055,621.7265,1230.8119,640.6095,1042.3362,969.3106,846.6535,924.647,865.1469,1127.3293,841.3736,956.6294,719.9908,938.5065,1135.814,747.2049,519.962,1075.4783,678.8689,699.2434,1198.6899,639.1128,1056.3319,885.484,719.4737,917.5551,872.3543,1110.5337,861.0797,938.6773,766.1234,879.631,972.6155,664.9044,383.8976,1073.4808,600.6131,502.8776,1140.522,664.3466,1011.0129,952.4307,765.929,933.3191,831.6761,1052.0579,862.0744,900.3464,634.5917,860.5606,1036.8819,558.7697,120.8962,1021.4083,567.857,336.3792,1263.4353,593.5204,1030.4635,960.9844,811.2826,916.478,762.5715,1194.9191,918.4139,947.1605,380.1739,308.4659,1158.0076,723.7338,427.7092,1037.6483,676.9302,663.3744,1191.7166,644.5761,1002.6842,997.4638,786.5643,928.4242,823.537,1064.3608,868.1813,892.5236,520.867,802.7708,1196.3118,733.9404,492.3396,1110.8397,658.7742,534.6352,1271.7048,637.0352,1057.5279,1008.4452,794.1075,980.5933,923.008,1098.2958,913.2731,949.1395,801.0919,937.5295,1121.9666,718.9527,370.9105,1136.4529,656.9833,646.8497,1243.3816,640.825,1072.1069,988.8428,879.9345,932.9947,851.1058,1129.0753,873.4977,917.0925,633.7478,969.2923,1162.7279,777.743,588.5714,1089.8134,671.5765,534.6993,1298.547,652.8664,1027.2366,1063.1829,864.3421,879.945,942.0416,1131.4764,989.4238,1016.1249,704.1297,977.1304,1226.9275,718.896,382.0641,1077.37,675.6053,498.5851,1303.2306,708.2002,1068.5965,995.1589,812.0069,1051.4468,774.0047,1214.7085,902.9239,943.8877,427.4289,616.9728,1034.8704,661.4685,533.1019,997.3627,611.844,567.3719,1214.0635,663.4268,985.3926,860.3931,768.798,862.7084,853.4526,1106.2887,888.1765,932.2571,664.8417,809.8898],[0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.003,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0022,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.0031,0.0031,0.0021,0.0007,0.0068,0.0006,0.0003,0.0005,0.0072,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0029,0.0031,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0058,0.0005,0.0026,0.0035,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.007,0.0006,0.0003,0.0005,0.0075,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.0032,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0031,0.0018,0.0008,0.0072,0.0006,0.0003,0.0005,0.007,0.0004,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0069,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0024,0.0031,0.003,0.0015,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0028,0.0024,0.0031,0.0029,0.0021,0.0008,0.0065,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0023,0.003,0.0032,0.0018,0.0008,0.007,0.0006,0.0003,0.0005,0.0076,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0031,0.003,0.0022,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0029,0.0026,0.0023,0.0015,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0065,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0024,0.0029,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0055,0.0005,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.0031,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0023,0.0031,0.0032,0.0019,0.0008,0.007,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0031,0.0027,0.0023,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0035,0.0014,0.0022,0.0022,0.0028,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.003,0.003,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0077,0.0004,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0024,0.0031,0.0032,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0077,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.003,0.0032,0.002,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.0027,0.0026,0.0023,0.0031,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0027,0.0023,0.0031,0.0031,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.007,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0028,0.0026,0.0022,0.0029,0.0031,0.0018,0.0008,0.0073,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0015,0.0033,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0032,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0076,0.0005,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.003,0.003,0.0015,0.0008,0.007,0.0006,0.0003],["1","31","61","91","121","151","181","211","241","270","300","330","360","390","420","450","480","510","2","32","62","92","122","152","182","212","242","271","301","331","361","391","421","451","481","511","3","33","63","93","123","153","183","213","243","272","302","332","362","392","422","452","482","512","4","34","64","94","124","154","184","214","244","273","303","333","363","393","423","453","483","513","5","35","65","95","125","155","185","215","245","274","304","334","364","394","424","454","484","514","6","36","66","96","126","156","186","216","246","275","305","335","365","395","425","455","485","515","7","37","67","97","127","157","187","217","247","276","306","336","366","396","426","456","486","516","8","38","68","98","128","158","188","218","248","277","307","337","367","397","427","457","487","517","9","39","69","99","129","159","189","219","278","308","338","368","398","428","458","488","518","10","40","70","100","130","160","190","220","249","279","309","339","369","399","429","459","489","519","11","41","71","101","131","161","191","221","250","280","310","340","370","400","430","460","490","520","12","42","72","102","132","162","192","222","251","281","311","341","371","401","431","461","491","521","13","43","73","103","133","163","193","223","252","282","312","342","372","402","432","462","492","522","14","44","74","104","134","164","194","224","253","283","313","343","373","403","433","463","493","523","15","45","75","105","135","165","195","225","254","284","314","344","374","404","434","464","494","524","16","46","76","106","136","166","196","226","255","285","315","345","375","405","435","465","495","525","17","47","77","107","137","167","197","227","256","286","316","346","376","406","436","466","496","526","18","48","78","108","138","168","198","228","257","287","317","347","377","407","437","467","497","527","19","49","79","109","139","169","199","229","258","288","318","348","378","408","438","468","498","528","20","50","80","110","140","170","200","230","259","289","319","349","379","409","439","469","499","529","21","51","81","111","141","171","201","231","260","290","320","350","380","410","440","470","500","530","22","52","82","112","142","172","202","232","261","291","321","351","381","411","441","471","501","531","23","53","83","113","143","173","203","233","262","292","322","352","382","412","442","472","502","532","24","54","84","114","144","174","204","234","263","293","323","353","383","413","443","473","503","533","25","55","85","115","145","175","205","235","264","294","324","354","384","414","444","474","504","534","26","56","86","116","146","176","206","236","265","295","325","355","385","415","445","475","505","535","27","57","87","117","147","177","207","237","266","296","326","356","386","416","446","476","506","536","28","58","88","118","148","178","208","238","267","297","327","357","387","417","447","477","507","537","29","59","89","119","149","179","209","239","268","298","328","358","388","418","448","478","508","538","30","60","90","120","150","180","210","240","269","299","329","359","389","419","449","479","509","539"],[1053.8866,676.7815,392.8929,996.9302,594.2478,507.974,1139.6655,579.7078,934.1587,946.9406,774.4448,865.6055,726.9124,983.6489,804.7397,845.632,709.3489,775.3103,1027.1622,722.1599,503.1301,1025.1892,633.6133,517.7712,1108.7641,571.7162,987.229,950.0426,766.5155,905.1625,816.2491,1097.7538,866.4714,910.6443,638.3879,725.5895,1009.4218,633.6128,332.5626,1014.2059,539.3672,472.3367,1195.5875,564.4037,1016.252,879.7536,718.4646,907.8125,812.6829,1061.9315,796.2194,892.8501,562.6414,827.8593,1089.2723,704.0955,304.5675,1089.4772,653.1073,592.0598,1304.2087,664.9833,1068.0228,1009.6937,851.6733,903.7414,890.8353,1163.2532,970.1837,895.9254,506.1368,734.304,1090.5304,739.3209,592.466,1089.5642,685.918,559.4916,1185.9003,575.5621,1038.3792,997.5589,791.2077,957.1595,859.4904,1111.9505,910.5966,943.0543,749.5163,867.4408,1150.692,656.4582,449.8179,1049.6715,627.7268,503.8572,1233.2753,677.2698,1035.6364,954.2988,778.0865,1006.6036,805.4829,1121.5267,988.3112,937.2274,632.4238,779.1075,1097.3551,671.4843,579.4652,1028.5792,646.827,550.6783,1176.4371,660.9539,992.6642,934.4613,742.5032,911.099,827.1977,1078.6085,895.9185,914.619,652.5142,803.8281,1103.081,718.0599,460.6554,1032.5355,594.6389,518.6391,1259.6865,562.2457,996.2633,961.2831,800.4131,937.8476,853.6622,1052.7072,971.0859,866.2121,544.0553,793.7979,922.5899,709.4098,386.7818,1050.5679,575.0502,497.1411,1221.5307,643.6717,947.0956,740.8071,1006.5718,903.6079,1181.4019,918.3671,909.1477,574.101,815.8738,1054.3164,755.8813,480.8976,1067.3788,621.0092,559.114,1169.668,626.7983,1039.1057,967.0675,838.0475,929.3435,848.5628,1105.3719,898.0492,930.8742,689.1034,864.3331,999.1097,715.1165,438.6576,1046.7004,628.299,558.4185,1224.9927,593.9753,959.6689,917.2466,806.2453,932.49,858.1894,1094.3399,876.907,957.78,444.9161,864.0282,1023.8673,719.3742,468.7252,1098.907,674.5178,654.5293,1243.4191,630.2589,1023.8724,967.954,758.7308,900.8072,832.2861,1138.0755,934.3945,942.6088,705.7516,892.0432,1072.3373,699.6103,470.4842,1027.1579,698.4183,629.3681,1232.3287,646.5887,1057.6889,1005.6961,841.3199,966.6152,897.6806,1037.5935,970.5646,964.3121,648.8251,871.701,1073.4952,686.8034,396.0211,1063.6929,661.0613,535.0826,1256.421,634.8302,1014.3765,985.3576,808.9862,883.3933,843.696,1106.632,928.8835,971.4191,623.1526,840.1954,1114.3559,754.0145,478.112,1060.6085,653.4128,572.2138,1085.9641,605.1138,1012.4136,946.0043,821.4094,899.4805,881.3319,1086.2169,908.6316,903.3281,806.5929,904.2097,1043.8328,759.2007,573.3388,1050.4746,643.7284,558.6211,1188.099,614.9632,1014.219,948.3734,739.0545,940.6905,820.2828,1047.6319,875.6876,887.6357,730.6119,871.6724,1150.1793,656.188,480.9883,1051.9555,576.9626,473.1233,1168.02,607.3712,967.1922,915.9611,771.8106,920.0899,825.1826,1035.035,901.5642,899.1313,712.5504,897.6359,1120.4837,703.4517,497.2202,1058.9769,601.5671,508.4099,1207.8247,650.7281,1039.6131,940.2251,737.8518,934.756,854.0729,1072.9639,973.1285,921.5247,695.5008,881.1877,1042.1305,719.8604,514.9874,1018.1299,679.0853,552.6704,1192.4878,582.8249,1003.7864,984.3321,768.4423,877.6816,869.2046,1076.9676,846.2377,918.5617,640.8117,789.0546,1070.516,738.2938,493.378,1004.628,614.6431,614.8886,1191.4263,642.8286,996.8887,982.9421,801.407,920.3538,885.6995,1058.0462,886.8602,951.0668,767.8935,877.0623,1073.8057,778.2274,602.2978,1078.9502,658.6054,621.7264,1230.8119,640.6095,1042.3362,969.3106,846.6535,924.6471,865.1468,1127.3292,841.3737,956.6295,719.9908,938.5065,1135.814,747.2049,519.962,1075.4783,678.8689,699.2434,1198.6899,639.1128,1056.3319,885.484,719.4737,917.5551,872.3539,1110.5337,861.0811,938.6774,766.1234,879.6305,972.6155,664.9044,383.8976,1073.4808,600.6131,502.8776,1140.5221,664.3466,1011.0129,952.4307,765.929,933.3191,831.6767,1052.0579,862.0759,900.3465,634.5917,860.5608,1036.8819,558.77,120.8962,1021.4083,567.857,336.3792,1263.4354,593.5204,1030.4635,960.9844,811.2826,916.4781,762.5712,1194.919,918.4153,947.1607,380.1739,308.466,1158.0076,723.734,427.7092,1037.6483,676.9301,663.3744,1191.7166,644.5761,1002.6841,997.4638,786.5643,928.4242,823.5368,1064.3609,868.1825,892.5237,520.867,802.7706,1196.3118,733.9405,492.3396,1110.8397,658.7742,534.6352,1271.7048,637.0352,1057.5279,1008.4452,794.1075,980.5933,923.0082,1098.2958,913.2719,949.1393,801.0919,937.5288,1121.9666,718.9529,370.9105,1136.4529,656.9831,646.8497,1243.3817,640.825,1072.1069,988.8428,879.9345,932.9946,851.1055,1129.0753,873.4963,917.0925,633.7478,969.2927,1162.7279,777.7428,588.5714,1089.8134,671.5765,534.6993,1298.547,652.8664,1027.2366,1063.1829,864.3421,879.945,942.0414,1131.4764,989.4233,1016.125,704.1297,977.1305,1226.9275,718.8961,382.0641,1077.37,675.6051,498.5851,1303.2306,708.2002,1068.5965,995.1589,812.0069,1051.4467,774.0045,1214.7085,902.9243,943.8877,427.4289,616.9727,1034.8704,661.4686,533.1019,997.3627,611.8438,567.3719,1214.0636,663.4267,985.3926,860.3931,768.798,862.7084,853.453,1106.2887,888.1779,932.257,664.8417,809.8908],[0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.003,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0022,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.0031,0.0031,0.0021,0.0007,0.0068,0.0006,0.0003,0.0005,0.0072,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0029,0.0031,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0058,0.0005,0.0026,0.0035,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.007,0.0006,0.0003,0.0005,0.0075,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.0032,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0031,0.0018,0.0008,0.0072,0.0006,0.0003,0.0005,0.007,0.0004,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0069,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0024,0.0031,0.003,0.0015,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0028,0.0024,0.0031,0.0029,0.0021,0.0008,0.0065,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0023,0.003,0.0032,0.0018,0.0008,0.007,0.0006,0.0003,0.0005,0.0076,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0031,0.003,0.0022,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0029,0.0026,0.0023,0.0015,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0065,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0024,0.0029,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0055,0.0005,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.0031,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0023,0.0031,0.0032,0.0019,0.0008,0.007,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0031,0.0027,0.0023,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0035,0.0014,0.0022,0.0022,0.0028,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.003,0.003,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0077,0.0004,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0024,0.0031,0.0032,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0077,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.003,0.0032,0.002,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.0027,0.0026,0.0023,0.0031,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0027,0.0023,0.0031,0.0031,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.007,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0028,0.0026,0.0022,0.0029,0.0031,0.0018,0.0008,0.0073,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0015,0.0033,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0032,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0076,0.0005,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.003,0.003,0.0015,0.0008,0.007,0.0006,0.0003],["2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>zone<\/th>\n      <th>location<\/th>\n      <th>yield_lsm<\/th>\n      <th>smith.w.x<\/th>\n      <th>units<\/th>\n      <th>yield<\/th>\n      <th>smith.w.y<\/th>\n      <th>year<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy"},{"extend":"excel","filename":"file"}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"45vh","autoWidth":true,"columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[3,4,6,7]}],"initComplete":"function(settings, json) {\n$(this).addClass('compact');\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script>
<p>The BLUEs correlation between <code>H2Cal</code> and
<code>asrml</code> is (r = 1)</p>
</div>
<div id="blups-comparison" class="section level2">
<h2>BLUPs comparison</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>blups.comp <span class="ot">&lt;-</span> <span class="fu">merge</span>(blups.asrml, blups.h2cal</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                    , <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;cultivar&quot;</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(blups.comp$yield, blups.comp$predicted.value)</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">cor</span>(blups.comp<span class="sc">$</span>yield, blups.comp<span class="sc">$</span>predicted.value) </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;r =&quot;</span>, rs)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## r = 0.9818724</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>blups.comp <span class="sc">%&gt;%</span> <span class="fu">web_table</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-c772d0314d49a7057bbd" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c772d0314d49a7057bbd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","Scroller"],"data":[["22455","23286","23524","24054","24521","24984","25512","25965","26362","26742","26777","27110","27125","27130","27543","27546","27548","27590","27592","27593","27599","27600","27605","27609","27669","28128","28209","28949","28950","28954"],[803.0416,829.9464,803.9139,863.9497,869.3613,856.3303,843.4225,839.2455,845.3827,859.0269,838.4568,865.3885,873.3932,854.3928,856.116,849.1157,831.7283,852.3404,843.3664,859.1327,878.9646,866.741,831.1319,798.9066,849.4817,885.1459,873.5456,899.6503,866.7809,836.237],[53.6173,53.619,53.6178,53.6172,53.6283,53.6266,53.6179,53.6278,53.6757,53.6208,53.6183,53.6171,53.617,53.619,53.6158,53.6259,53.6177,53.6293,53.6192,53.6193,53.6167,53.619,53.6281,53.6173,53.6279,53.6185,53.6191,53.625,53.6156,53.6318],["Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable"],[773.0349,792.9172,770.178,819.8608,834.4507,819.5343,809.5808,803.7321,803.7272,821.8891,799.039,828.612,834.5181,816.1793,823.8045,815.6673,803.11,819.8147,805.8034,824.1073,841.8029,832.2422,794.8221,749.0031,811.5516,849.7517,836.3969,861.3521,819.9673,803.1781]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>predicted.value<\/th>\n      <th>std.error<\/th>\n      <th>status<\/th>\n      <th>yield<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy"},{"extend":"excel","filename":"file"}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"45vh","autoWidth":true,"columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[1,2,4]}],"initComplete":"function(settings, json) {\n$(this).addClass('compact');\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script>
<p>The BLUPs correlation between <code>H2Cal</code> and
<code>asrml</code> is (r = 0.9818724)</p>
</div>
</div>
<div id="single-stage-analysis" class="section level1">
<h1>Single-stage analysis</h1>
<div id="asreml-1" class="section level2">
<h2>asreml</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(asreml)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="st">&quot;scipen&quot;</span><span class="ot">=</span><span class="dv">100</span>,<span class="st">&quot;digits&quot;</span><span class="ot">=</span> <span class="dv">4</span> )</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">asreml.options</span>(<span class="at">maxit=</span><span class="dv">100</span>) <span class="co"># Set asreml iteration</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">##### Fit a single-stage model #####</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">## incomplete block and replicate location-specific</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="do">## location-specifice residual variance</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">asreml</span>(<span class="at">fixed       =</span> yield <span class="sc">~</span> zone,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">random      =</span> <span class="sc">~</span> rep<span class="sc">:</span><span class="fu">at</span>(location) <span class="sc">+</span> rep<span class="sc">:</span>alpha<span class="sc">:</span><span class="fu">at</span>(location) <span class="sc">+</span> zone<span class="sc">:</span>location <span class="sc">+</span> </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>                             cultivar <span class="sc">+</span> cultivar<span class="sc">:</span>zone<span class="sc">:</span>location<span class="sc">+</span> cultivar<span class="sc">:</span>zone,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">residual    =</span> <span class="sc">~</span> <span class="fu">dsum</span>(<span class="sc">~</span>(units)<span class="sc">|</span>location),</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">data        =</span> fb,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">predict     =</span> <span class="fu">predict.asreml</span>(<span class="at">classify =</span> <span class="st">&quot;cultivar&quot;</span>))</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="fu">update.asreml</span>(mod)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>blups.asreml <span class="ot">&lt;-</span> <span class="fu">data.frame</span>((mod<span class="sc">$</span>predictions<span class="sc">$</span>pvals[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>])) </span></code></pre></div>
</div>
<div id="h2cal-1" class="section level2">
<h2>H2cal</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(inti)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> fb <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">H2cal</span>(<span class="at">trait =</span> <span class="st">&quot;yield&quot;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        , <span class="at">gen.name =</span> <span class="st">&quot;cultivar&quot;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>        , <span class="at">env.name =</span> <span class="st">&quot;location&quot;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        , <span class="at">rep.n =</span> <span class="dv">2</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        , <span class="at">env.n =</span> <span class="dv">18</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        , <span class="at">fixed.model =</span> <span class="st">&quot;0 + zone + (1|rep:location) + (1|rep:alpha:location) + (1|zone:location) + (1|cultivar:zone) + (1|cultivar:zone:location) + cultivar&quot;</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        , <span class="at">random.model =</span> <span class="st">&quot;1 + zone + (1|rep:location) + (1|rep:alpha:location) + (1|zone:location) + (1|cultivar:zone) + (1|cultivar:zone:location) + (1|cultivar)&quot;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        , <span class="at">summary =</span> T</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        , <span class="at">emmeans =</span> T</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># , plot_diag = T</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Linear mixed model fit by REML [&#39;lmerMod&#39;]</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Formula: yield ~ 1 + zone + (1 | rep:location) + (1 | rep:alpha:location) +  </span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="do">##     (1 | zone:location) + (1 | cultivar:zone) + (1 | cultivar:zone:location) +  </span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="do">##     (1 | cultivar)</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="do">##    Data: dt.rm</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="do">## Weights: weights</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a><span class="do">## REML criterion at convergence: 11933.2</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="do">## Scaled residuals: </span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="do">##     Min      1Q  Median      3Q     Max </span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="do">## -5.0760 -0.3308 -0.0084  0.3698  4.0576 </span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Random effects:</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  Groups                 Name        Variance Std.Dev.</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  cultivar:zone:location (Intercept)  2209.5   47.00  </span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  rep:alpha:location     (Intercept)   944.6   30.73  </span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="do">##  cultivar:zone          (Intercept)   129.6   11.38  </span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  rep:location           (Intercept)   334.0   18.28  </span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  cultivar               (Intercept)   728.0   26.98  </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  zone:location          (Intercept) 48679.8  220.64  </span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  Residual                            1396.8   37.37  </span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="do">## Number of obs: 1069, groups:  </span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a><span class="do">## cultivar:zone:location, 539; rep:alpha:location, 251; cultivar:zone, 90; rep:location, 36; cultivar, 30; zone:location, 18</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="do">## Fixed effects:</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="do">##             Estimate Std. Error t value</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a><span class="do">## (Intercept)   813.35      83.85   9.700</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a><span class="do">## zonenorth      51.57     129.67   0.398</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="do">## zonesouth      59.75     123.21   0.485</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a><span class="do">## Correlation of Fixed Effects:</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="do">##           (Intr) znnrth</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a><span class="do">## zonenorth -0.644       </span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a><span class="do">## zonesouth -0.678  0.439</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>blups.h2cal <span class="ot">&lt;-</span> model<span class="sc">$</span>blups </span></code></pre></div>
</div>
<div id="blups-comparison-1" class="section level2">
<h2>BLUPs comparison</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>blups.comp <span class="ot">&lt;-</span> <span class="fu">merge</span>(blups.asreml, blups.h2cal, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;cultivar&quot;</span>))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(blups.comp$predicted.value, blups.comp$yield)</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>rs <span class="ot">&lt;-</span> <span class="fu">cor</span>(blups.comp<span class="sc">$</span>predicted.value, blups.comp<span class="sc">$</span>yield) </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;r =&quot;</span>, rs)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="do">## r = 0.9201732</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>blups.comp <span class="sc">%&gt;%</span> <span class="fu">web_table</span>(<span class="at">digits =</span> <span class="dv">4</span>)</span></code></pre></div>
<div id="htmlwidget-50e0e14e3fbb012dbdbe" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-50e0e14e3fbb012dbdbe">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","Scroller"],"data":[["22455","23286","23524","24054","24521","24984","25512","25965","26362","26742","26777","27110","27125","27130","27543","27546","27548","27590","27592","27593","27599","27600","27605","27609","27669","28128","28209","28949","28950","28954"],[799.6062,829.2253,804.4229,871.042,868.3307,855.0887,839.1676,840.7004,849.6037,859.6556,842.7738,863.9857,875.5788,856.7206,851.0877,842.821,826.2886,849.085,844.0249,856.6981,873.8515,862.3616,831.3956,814.917,853.4611,884.0226,874.3242,898.7078,877.4787,831.2612],[53.4514,53.454,53.4522,53.4502,53.4586,53.4566,53.4506,53.4559,53.5022,53.4513,53.4522,53.4502,53.4507,53.4513,53.4498,53.4627,53.4526,53.4595,53.4534,53.4532,53.4518,53.4528,53.4576,53.4512,53.4569,53.4519,53.4534,53.4608,53.4496,53.4584],["Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable"],[774.2085,793.3491,768.1799,821.6019,832.9218,820.0897,807.9516,801.2365,802.3588,823.093,797.5399,829.5655,832.3283,814.9198,824.0008,814.7511,802.124,817.5921,803.8942,824.6404,841.4552,832.5808,795.3311,746.9311,812.5252,849.1321,836.6204,859.9027,819.0341,800.7321]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>predicted.value<\/th>\n      <th>std.error<\/th>\n      <th>status<\/th>\n      <th>yield<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy"},{"extend":"excel","filename":"file"}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"45vh","autoWidth":true,"columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[1,2,4]}],"initComplete":"function(settings, json) {\n$(this).addClass('compact');\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script>
<p>The BLUPs correlation between <code>H2Cal</code> and
<code>asrml</code> is (r = 0.9201732)</p>
</div>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-buntaran2020Cross" class="csl-entry">
Buntaran, H., H.-P. Piepho, P. Schmidt, J. Rydén, M. Halling, et al.
2020. Cross-validation of stagewise mixed-model analysis of
<span>Swedish</span> variety trials with winter wheat and spring barley.
Crop Science 60(5): 2221–2240. doi: <a
href="https://doi.org/10.1002/csc2.20177">10.1002/csc2.20177</a>.
</div>
<div id="ref-R-inti" class="csl-entry">
Lozano-Isla, F. 2020. <a href="https://lozanoisla.com/">Inti: Tools and
statistical procedures in plant science</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>



    <footer><div class="pkgdown-footer-left">
  <p></p><p>Desarrollado por <a href="https://lozanoisla.com/" class="external-link">Flavio Lozano-Isla</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer></div>

  

  

  </body></html>
