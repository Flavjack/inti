<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Comparison: asreml and H2cal">
<title>Stagewise mixed-model analysis • inti</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Stagewise mixed-model analysis">
<meta property="og:description" content="Comparison: asreml and H2cal">
<meta property="og:image" content="https://inkaverse.com/reference/figures/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-804H2EJ8RN"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-804H2EJ8RN');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../../index.html">inti</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../articles/apps.html">
    <span class="fa fa-gamepad fa-lg"></span>
     
    Apps
  </a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown--articles">
    <span class="fa fa-book fa-lg"></span>
     
    Articles
  </a>
  <div class="dropdown-menu" aria-labelledby="dropdown--articles">
    <a class="dropdown-item" href="../../articles/tarpuy.html">Tarpuy: field-book experimental plans</a>
    <a class="dropdown-item" href="../../articles/yupana.html">Yupana: experimental design analysis</a>
    <a class="dropdown-item" href="../../articles/extra/yupana-coding.html">Yupana: coding workflow</a>
    <a class="dropdown-item" href="../../articles/rticles.html">Rticles: scientific documents with R</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../../articles/heritability.html">Broad-sense heritability in plant breeding</a>
    <a class="dropdown-item" href="../../articles/extra/stagewise.html">Stagewise mixed-model analysis</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../articles/policy.html">
    <span class="fa fa-shield-alt fa-lg"></span>
     
    Privacy Policy
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../reference/index.html">
    <span class="fa fa-file-code fa-lg"></span>
     
    Functions
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../../news/index.html">
    <span class="fa fa-file-alt fa-lg"></span>
     
    News
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/flavjack/inti/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/sponsors/Flavjack">
    <span class="fas fa fas fa-heart fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">
<script src="stagewise_files/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="stagewise_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="stagewise_files/datatables-binding-0.20/datatables.js"></script><script src="stagewise_files/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="stagewise_files/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="stagewise_files/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="stagewise_files/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><script src="stagewise_files/jszip-1.11.3/jszip.min.js"></script><link href="stagewise_files/dt-ext-buttons-1.11.3/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="stagewise_files/dt-ext-buttons-1.11.3/js/dataTables.buttons.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.11.3/js/buttons.html5.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.11.3/js/buttons.colVis.min.js"></script><script src="stagewise_files/dt-ext-buttons-1.11.3/js/buttons.print.min.js"></script><link href="stagewise_files/dt-ext-scroller-1.11.3/css/scroller.dataTables.min.css" rel="stylesheet">
<script src="stagewise_files/dt-ext-scroller-1.11.3/js/dataTables.scroller.min.js"></script><link href="stagewise_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="stagewise_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../../logo.png" class="logo" alt=""><h1>Stagewise mixed-model analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/flavjack/inti/blob/HEAD/vignettes/extra/stagewise.Rmd" class="external-link"><code>vignettes/extra/stagewise.Rmd</code></a></small>
      <div class="d-none name"><code>stagewise.Rmd</code></div>
    </div>

    
    
<p>Best linear unbiased prediction (BLUP) is used in plant breeding experiments for the selection of the best lines in multi-environmental trials (MET).</p>
<p>In this section, a comparison will be made between the <code>H2Cal()</code> function of the inti package <span class="citation">(<a href="#ref-R-inti" role="doc-biblioref">Lozano-Isla, 2020</a>)</span> and the code using the <code>asrml</code> package published by <span class="citation">Buntaran et al. (<a href="#ref-buntaran2020Cross" role="doc-biblioref">2020</a>)</span>.</p>
<p>For the comparison we will use the two methods described by <span class="citation">Buntaran et al. (<a href="#ref-buntaran2020Cross" role="doc-biblioref">2020</a>)</span>. (i) The “two-stage” analysis, using two stages, the first to calculate the BLUEs and the second the BLUPs. (ii) The “one stage” analysis using only one model to calculate the BLUPs.</p>
<div class="section level1">
<h1 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inkaverse.com/">inti</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="va">fb</span> <span class="op">&lt;-</span> <span class="fu">inti</span><span class="fu">::</span><span class="va"><a href="../../reference/met.html">met</a></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="two-stage-analysis">Two-stage analysis<a class="anchor" aria-label="anchor" href="#two-stage-analysis"></a>
</h1>
<div class="section level2">
<h2 id="asreml">asreml<a class="anchor" aria-label="anchor" href="#asreml"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.options.html" class="external-link">asreml.options</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Set asreml iteration</span>

<span class="co">############################</span>
<span class="co">##### Stage I LSMEANS #####</span>
<span class="co">##### per location   #####</span>

<span class="va">ww</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">fb</span><span class="op">)</span>

<span class="co">##### Make column Zone_Loc #####</span>

<span class="va">trials</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nlevels.html" class="external-link">nlevels</a></span><span class="op">(</span><span class="va">ww</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>
<span class="va">envs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">ww</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>

<span class="co">##### Make data list for Stage I #####</span>
<span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span>, 
                    dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">envs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data_Set"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co">##### Make a list of Trials #####</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">trials</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  <span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">ww</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>
  <span class="va">c</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">c</span><span class="op">)</span>
  <span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span>
  <span class="va">f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">ww</span>,<span class="va">env</span>,by<span class="op">=</span><span class="st">"env"</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"data_"</span>, <span class="va">b</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span>, <span class="va">f</span><span class="op">)</span>
  <span class="va">data_list</span><span class="op">[[</span><span class="va">i</span>, <span class="st">"data_Set"</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">f</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">b</span>, <span class="va">c</span>, <span class="va">f</span>, <span class="va">env</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">data_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html" class="external-link">ldply</a></span><span class="op">(</span><span class="va">data_list</span><span class="op">[</span>, <span class="st">"data_Set"</span><span class="op">]</span>, <span class="va">data.frame</span>, .id<span class="op">=</span><span class="st">"env"</span><span class="op">)</span><span class="op">)</span>

<span class="va">stgI_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">1</span>, 
                    dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">envs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lsmeans"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.options.html" class="external-link">asreml.options</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Set asreml iteration</span>

<span class="co">############################</span>
<span class="co">##### Stage I LSMEANS #####</span>
<span class="co">##### per location   #####</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">envs</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">edat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/droplevels.html" class="external-link">droplevels</a></span><span class="op">(</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/subset.data.table.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ww</span>, <span class="va">env</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>
  
  <span class="va">mod.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span>fixed     <span class="op">=</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">cultivar</span>,
                  random      <span class="op">=</span> <span class="op">~</span> <span class="va">rep</span> <span class="op">+</span> <span class="va">rep</span><span class="op">:</span><span class="va">alpha</span>,
                  data        <span class="op">=</span> <span class="va">edat</span>,
                  predict     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html" class="external-link">predict.asreml</a></span><span class="op">(</span>classify <span class="op">=</span> <span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html" class="external-link">update.asreml</a></span><span class="op">(</span><span class="va">mod.1</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/summary.asreml.html" class="external-link">summary.asreml</a></span><span class="op">(</span><span class="va">mod.1</span><span class="op">)</span><span class="op">$</span><span class="va">varcomp</span><span class="op">)</span>
  
  <span class="va">blue</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">mod.1</span>, classify<span class="op">=</span><span class="st">"cultivar"</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">edat</span><span class="op">$</span><span class="va">cultivar</span><span class="op">)</span>, vcov<span class="op">=</span><span class="cn">TRUE</span>,aliased <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="co"># get the lsmeans</span>
  <span class="va">blue.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">blue</span><span class="op">$</span><span class="va">pvals</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">blue.1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cultivar"</span>, <span class="st">"yield_lsm"</span>, <span class="st">"se"</span><span class="op">)</span>
  <span class="va">blue.1</span><span class="op">[</span> , <span class="st">':='</span><span class="op">(</span>var<span class="op">=</span><span class="va">se</span><span class="op">^</span><span class="fl">2</span>, smith.w<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/solve-methods.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">blue</span><span class="op">$</span><span class="va">vcov</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">]</span> <span class="co"># calculate the Smith's weight</span>
  
  <span class="va">stgI_list</span><span class="op">[[</span><span class="va">i</span>, <span class="st">"lsmeans"</span> <span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">blue.1</span> <span class="co"># put all the results of Stage 1 in the list</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">Edat</span>,<span class="va">mod.1</span>, <span class="va">blue</span>, <span class="va">blue.1</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">#######################################################</span>
<span class="co">##### Preparing dataset of Stage I for Stage II ######</span>

<span class="co">##### Unlist the results of Stage I and format as data.table #####</span>
<span class="va">stgII_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ldply.html" class="external-link">ldply</a></span><span class="op">(</span><span class="va">stgI_list</span><span class="op">[</span>, <span class="st">"lsmeans"</span><span class="op">]</span>, <span class="va">data.frame</span>, .id<span class="op">=</span><span class="st">"env"</span><span class="op">)</span><span class="op">)</span>

<span class="va">stgII_list</span><span class="op">$</span><span class="va">zone</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_fixed</a></span><span class="op">(</span><span class="va">stgII_list</span><span class="op">$</span><span class="va">env</span>, <span class="st">"_"</span>, <span class="fl">2</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="co"># Make Zone column by split the record in Zone_Loc column</span>
<span class="va">stgII_list</span><span class="op">$</span><span class="va">location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_fixed</a></span><span class="op">(</span><span class="va">stgII_list</span><span class="op">$</span><span class="va">env</span>, <span class="st">"_"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Make Location by split the record in Zone_Loc column</span>
<span class="va">stgII_list</span><span class="op">$</span><span class="va">year</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split_fixed</a></span><span class="op">(</span><span class="va">stgII_list</span><span class="op">$</span><span class="va">env</span>, <span class="st">"_"</span>, <span class="fl">3</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="co"># Make Year by split the record in Zone_Loc column</span>

<span class="va">blues.asreml</span> <span class="op">&lt;-</span> <span class="va">stgII_list</span>

<span class="co">############################</span>
<span class="co">##### Stage II BLUPs ######</span>
<span class="co">##### Zone analysis #####</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span><span class="va">yield_lsm</span>  <span class="op">~</span> <span class="va">zone</span>,
                random    <span class="op">=</span> <span class="op">~</span><span class="va">cultivar</span> <span class="op">+</span> <span class="va">zone</span><span class="op">:</span><span class="va">location</span> <span class="op">+</span> <span class="va">zone</span><span class="op">:</span><span class="va">cultivar</span> <span class="op">+</span> <span class="va">cultivar</span><span class="op">:</span><span class="va">zone</span><span class="op">:</span><span class="va">location</span>,
                weights   <span class="op">=</span> <span class="va">smith.w</span>,
                family    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asr_families.html" class="external-link">asr_gaussian</a></span><span class="op">(</span>dispersion<span class="op">=</span><span class="fl">1.0</span><span class="op">)</span>, <span class="co"># fix residual variance to 1</span>
                data      <span class="op">=</span> <span class="va">blues.asreml</span>,
                predict   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html" class="external-link">predict.asreml</a></span><span class="op">(</span>classify <span class="op">=</span> <span class="st">"cultivar"</span><span class="op">)</span>
                <span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html" class="external-link">update.asreml</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>

<span class="co"># print(summary.asreml(model)$varcomp) # print the variance components</span>

<span class="va">blups.asrml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">predictions</span><span class="op">$</span><span class="va">pvals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="h2cal">H2cal<a class="anchor" aria-label="anchor" href="#h2cal"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inkaverse.com/">inti</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>

<span class="co">#&gt; First stage</span>

<span class="va">envs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">fb</span><span class="op">$</span><span class="va">env</span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">envs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">model</span> <span class="op">&lt;-</span> <span class="va">fb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">env</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">envs</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
    
    <span class="fu"><a href="../../reference/H2cal.html">H2cal</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="st">"yield"</span>
          , gen.name <span class="op">=</span> <span class="st">"cultivar"</span>
          , rep.n <span class="op">=</span> <span class="fl">4</span>
          , fixed.model <span class="op">=</span> <span class="st">"0 + (1|rep) + (1|rep:alpha) + cultivar"</span>
          , random.model <span class="op">=</span> <span class="st">"1 + (1|rep) + (1|rep:alpha) + (1|cultivar)"</span>
          <span class="co"># , plot_diag = T</span>
          , emmeans <span class="op">=</span> <span class="cn">F</span>
          <span class="op">)</span>
  
  <span class="va">blues</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">blues</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>trial <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">fb</span><span class="op">$</span><span class="va">env</span><span class="op">)</span><span class="op">[</span><span class="va">x</span><span class="op">]</span><span class="op">)</span>
  
  <span class="op">}</span><span class="op">)</span>

<span class="va">blues.h2cal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html" class="external-link">separate</a></span><span class="op">(</span><span class="va">trial</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"zone"</span>, <span class="st">"location"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yield</span>, <span class="va">smith.w</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yield</span>, <span class="va">smith.w</span><span class="op">)</span>, <span class="va">as.factor</span><span class="op">)</span><span class="op">)</span>

<span class="co">#&gt; Second stage</span>

<span class="va">met</span> <span class="op">&lt;-</span> <span class="va">blues.h2cal</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="op">!</span><span class="va">yield</span>, <span class="va">as.factor</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="../../reference/H2cal.html">H2cal</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="st">"yield"</span>
        , gen.name <span class="op">=</span> <span class="st">"cultivar"</span>
        , rep.n <span class="op">=</span> <span class="fl">4</span>
        , env.n <span class="op">=</span> <span class="fl">18</span>
        , env.name <span class="op">=</span> <span class="st">"location"</span>
        , fixed.model <span class="op">=</span> <span class="st">"0 + zone + (1|zone:location) + (1|zone:cultivar) + cultivar"</span>
        , random.model <span class="op">=</span> <span class="st">"1 + zone + (1|zone:location) + (1|zone:cultivar) + (1|cultivar)"</span>
        <span class="co"># , plot_diag = T</span>
        , emmeans <span class="op">=</span> <span class="cn">T</span>
        <span class="co"># , weights = blues.h2cal$smith.w</span>
        <span class="op">)</span>

<span class="va">blups.h2cal</span> <span class="op">&lt;-</span> <span class="va">met</span><span class="op">$</span><span class="va">blups</span></code></pre></div>
<ul>
<li>First stage
<ul>
<li>Fixed model with <code>0 +</code> for avoid intercep and calculate all the BLUEs.</li>
<li>
<code>emmeans = F</code> to calculate the Smith weitghts in the first stage</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="blues-comparison">BLUEs comparison<a class="anchor" aria-label="anchor" href="#blues-comparison"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blues.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">blues.asreml</span> 
                    , <span class="va">blues.h2cal</span> 
                    , by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cultivar"</span>, <span class="st">"zone"</span>, <span class="st">"location"</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Online License checked out Sat Dec 11 16:29:21 2021</span>

<span class="co"># plot(blues.comp$yield, blues.comp$yield_lsm)</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">blues.comp</span><span class="op">$</span><span class="va">yield</span>, <span class="va">blues.comp</span><span class="op">$</span><span class="va">yield_lsm</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"r ="</span>, <span class="va">rs</span><span class="op">)</span>
<span class="co">## r = 1</span>

<span class="va">blues.comp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/web_table.html">web_table</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-97a004fe59f9a0506461" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-97a004fe59f9a0506461">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","Scroller"],"data":[["22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","22455","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23286","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","23524","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24054","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24521","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","24984","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25512","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","25965","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26362","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26742","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","26777","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27110","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27125","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27130","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27543","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27546","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27548","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27590","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27592","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27593","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27599","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27600","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27605","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27609","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","27669","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28128","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28209","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28949","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28950","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954","28954"],["middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south","middle","middle","middle","middle","middle","middle","middle","north","north","north","north","north","south","south","south","south","south","south"],["07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35","07bm27","07bm28","07bm29","07bm32","07bm36","07bm37","07bm39","07bm25","07bm26","07bm38","07bm40","07bm41","07bm20","07bm21","07bm22","07bm23","07bm30","07bm35"],[1053.8867,676.7814,392.8929,996.9302,594.2476,507.974,1139.6655,579.7078,934.1587,946.9406,774.4448,865.6055,726.9123,983.6488,804.7414,845.6318,709.3489,775.3109,1027.1622,722.1601,503.1301,1025.1892,633.6131,517.7712,1108.7641,571.7162,987.229,950.0426,766.5155,905.1625,816.2493,1097.7538,866.4721,910.6445,638.3879,725.5896,1009.4218,633.6128,332.5626,1014.2059,539.3671,472.3368,1195.5875,564.4037,1016.252,879.7536,718.4646,907.8125,812.6835,1061.9315,796.2178,892.8501,562.6414,827.8594,1089.2723,704.0956,304.5675,1089.4772,653.1072,592.0598,1304.2087,664.9833,1068.0228,1009.6937,851.6733,903.7414,890.8349,1163.2533,970.1844,895.9256,506.1368,734.3033,1090.5304,739.3209,592.466,1089.5642,685.9182,559.4916,1185.9003,575.5621,1038.3792,997.5589,791.2077,957.1595,859.4897,1111.9505,910.5981,943.0544,749.5163,867.4415,1150.692,656.4584,449.8178,1049.6715,627.7268,503.8572,1233.2753,677.2698,1035.6365,954.2988,778.0865,1006.6036,805.4828,1121.5267,988.3123,937.2278,632.4238,779.1072,1097.3551,671.4843,579.4652,1028.5792,646.8271,550.6783,1176.4371,660.954,992.6642,934.4613,742.5032,911.099,827.1972,1078.6084,895.919,914.6187,652.5142,803.8281,1103.081,718.0598,460.6553,1032.5355,594.6389,518.6391,1259.6865,562.2456,996.2633,961.2831,800.4131,937.8475,853.6626,1052.7072,971.0863,866.2121,544.0553,793.7977,922.5899,709.4097,386.7818,1050.5679,575.0502,497.1411,1221.5307,643.6717,947.0956,740.8071,1006.5718,903.6079,1181.402,918.3689,909.1477,574.101,815.8749,1054.3164,755.8814,480.8976,1067.3788,621.0092,559.114,1169.668,626.7982,1039.1057,967.0675,838.0475,929.3435,848.5631,1105.3719,898.0506,930.8744,689.1034,864.3326,999.1097,715.1168,438.6576,1046.7004,628.2988,558.4185,1224.9926,593.9752,959.6689,917.2466,806.2453,932.49,858.1893,1094.3399,876.9082,957.78,444.9161,864.0288,1023.8673,719.3739,468.7252,1098.907,674.5178,654.5294,1243.4191,630.2589,1023.8723,967.954,758.7308,900.8072,832.2856,1138.0755,934.3942,942.6088,705.7516,892.0426,1072.3373,699.61,470.4842,1027.1579,698.4183,629.3681,1232.3287,646.5887,1057.6889,1005.6961,841.3199,966.6152,897.6809,1037.5935,970.5648,964.3123,648.8251,871.7005,1073.4953,686.8036,396.0211,1063.6929,661.0611,535.0826,1256.421,634.8302,1014.3765,985.3576,808.9862,883.3932,843.6963,1106.632,928.884,971.419,623.1526,840.1952,1114.3559,754.0145,478.112,1060.6085,653.4129,572.2138,1085.964,605.1138,1012.4136,946.0043,821.4094,899.4806,881.3316,1086.2169,908.6311,903.3283,806.5929,904.2089,1043.8328,759.2008,573.3388,1050.4746,643.7286,558.6211,1188.099,614.9631,1014.219,948.3734,739.0545,940.6905,820.2823,1047.632,875.6889,887.6357,730.6119,871.6726,1150.1793,656.1881,480.9883,1051.9555,576.9628,473.1233,1168.02,607.3712,967.1922,915.9611,771.8106,920.09,825.1822,1035.035,901.5656,899.1311,712.5504,897.6361,1120.4837,703.452,497.2201,1058.9769,601.5671,508.4099,1207.8246,650.7281,1039.6131,940.2251,737.8518,934.756,854.0733,1072.9639,973.1298,921.5245,695.5008,881.1882,1042.1306,719.8604,514.9874,1018.1299,679.0851,552.6704,1192.4877,582.8249,1003.7864,984.3321,768.4423,877.6816,869.2047,1076.9676,846.2381,918.5616,640.8117,789.0549,1070.5161,738.2939,493.378,1004.628,614.643,614.8886,1191.4263,642.8286,996.8887,982.9421,801.407,920.3538,885.6998,1058.0462,886.8597,951.0664,767.8935,877.0625,1073.8058,778.2273,602.2978,1078.9502,658.6055,621.7265,1230.8119,640.6095,1042.3362,969.3106,846.6535,924.647,865.1469,1127.3293,841.3736,956.6294,719.9908,938.5065,1135.814,747.2049,519.962,1075.4783,678.8689,699.2434,1198.6899,639.1128,1056.3319,885.484,719.4737,917.5551,872.3543,1110.5337,861.0797,938.6773,766.1234,879.631,972.6155,664.9044,383.8976,1073.4808,600.6131,502.8776,1140.522,664.3466,1011.0129,952.4307,765.929,933.3191,831.6761,1052.0579,862.0744,900.3464,634.5917,860.5606,1036.8819,558.7697,120.8962,1021.4083,567.857,336.3792,1263.4353,593.5204,1030.4635,960.9844,811.2826,916.478,762.5715,1194.9191,918.4139,947.1605,380.1739,308.4659,1158.0076,723.7338,427.7092,1037.6483,676.9302,663.3744,1191.7166,644.5761,1002.6842,997.4638,786.5643,928.4242,823.537,1064.3608,868.1813,892.5236,520.867,802.7708,1196.3118,733.9404,492.3396,1110.8397,658.7742,534.6352,1271.7048,637.0352,1057.5279,1008.4452,794.1075,980.5933,923.008,1098.2958,913.2731,949.1395,801.0919,937.5295,1121.9666,718.9527,370.9105,1136.4529,656.9833,646.8497,1243.3816,640.825,1072.1069,988.8428,879.9345,932.9947,851.1058,1129.0753,873.4977,917.0925,633.7478,969.2923,1162.7279,777.743,588.5714,1089.8134,671.5765,534.6993,1298.547,652.8664,1027.2366,1063.1829,864.3421,879.945,942.0416,1131.4764,989.4238,1016.1249,704.1297,977.1304,1226.9275,718.896,382.0641,1077.37,675.6053,498.5851,1303.2306,708.2002,1068.5965,995.1589,812.0069,1051.4468,774.0047,1214.7085,902.9239,943.8877,427.4289,616.9728,1034.8704,661.4685,533.1019,997.3627,611.844,567.3719,1214.0635,663.4268,985.3926,860.3931,768.798,862.7084,853.4526,1106.2887,888.1765,932.2571,664.8417,809.8898],[0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.003,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0022,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.0031,0.0031,0.0021,0.0007,0.0068,0.0006,0.0003,0.0005,0.0072,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0029,0.0031,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0058,0.0005,0.0026,0.0035,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.007,0.0006,0.0003,0.0005,0.0075,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.0032,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0031,0.0018,0.0008,0.0072,0.0006,0.0003,0.0005,0.007,0.0004,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0069,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0024,0.0031,0.003,0.0015,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0028,0.0024,0.0031,0.0029,0.0021,0.0008,0.0065,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0023,0.003,0.0032,0.0018,0.0008,0.007,0.0006,0.0003,0.0005,0.0076,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0031,0.003,0.0022,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0029,0.0026,0.0023,0.0015,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0065,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0024,0.0029,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0055,0.0005,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.0031,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0023,0.0031,0.0032,0.0019,0.0008,0.007,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0031,0.0027,0.0023,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0035,0.0014,0.0022,0.0022,0.0028,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.003,0.003,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0077,0.0004,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0024,0.0031,0.0032,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0077,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.003,0.0032,0.002,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.0027,0.0026,0.0023,0.0031,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0027,0.0023,0.0031,0.0031,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.007,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0028,0.0026,0.0022,0.0029,0.0031,0.0018,0.0008,0.0073,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0015,0.0033,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0032,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0076,0.0005,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.003,0.003,0.0015,0.0008,0.007,0.0006,0.0003],["1","31","61","91","121","151","181","211","241","270","300","330","360","390","420","450","480","510","2","32","62","92","122","152","182","212","242","271","301","331","361","391","421","451","481","511","3","33","63","93","123","153","183","213","243","272","302","332","362","392","422","452","482","512","4","34","64","94","124","154","184","214","244","273","303","333","363","393","423","453","483","513","5","35","65","95","125","155","185","215","245","274","304","334","364","394","424","454","484","514","6","36","66","96","126","156","186","216","246","275","305","335","365","395","425","455","485","515","7","37","67","97","127","157","187","217","247","276","306","336","366","396","426","456","486","516","8","38","68","98","128","158","188","218","248","277","307","337","367","397","427","457","487","517","9","39","69","99","129","159","189","219","278","308","338","368","398","428","458","488","518","10","40","70","100","130","160","190","220","249","279","309","339","369","399","429","459","489","519","11","41","71","101","131","161","191","221","250","280","310","340","370","400","430","460","490","520","12","42","72","102","132","162","192","222","251","281","311","341","371","401","431","461","491","521","13","43","73","103","133","163","193","223","252","282","312","342","372","402","432","462","492","522","14","44","74","104","134","164","194","224","253","283","313","343","373","403","433","463","493","523","15","45","75","105","135","165","195","225","254","284","314","344","374","404","434","464","494","524","16","46","76","106","136","166","196","226","255","285","315","345","375","405","435","465","495","525","17","47","77","107","137","167","197","227","256","286","316","346","376","406","436","466","496","526","18","48","78","108","138","168","198","228","257","287","317","347","377","407","437","467","497","527","19","49","79","109","139","169","199","229","258","288","318","348","378","408","438","468","498","528","20","50","80","110","140","170","200","230","259","289","319","349","379","409","439","469","499","529","21","51","81","111","141","171","201","231","260","290","320","350","380","410","440","470","500","530","22","52","82","112","142","172","202","232","261","291","321","351","381","411","441","471","501","531","23","53","83","113","143","173","203","233","262","292","322","352","382","412","442","472","502","532","24","54","84","114","144","174","204","234","263","293","323","353","383","413","443","473","503","533","25","55","85","115","145","175","205","235","264","294","324","354","384","414","444","474","504","534","26","56","86","116","146","176","206","236","265","295","325","355","385","415","445","475","505","535","27","57","87","117","147","177","207","237","266","296","326","356","386","416","446","476","506","536","28","58","88","118","148","178","208","238","267","297","327","357","387","417","447","477","507","537","29","59","89","119","149","179","209","239","268","298","328","358","388","418","448","478","508","538","30","60","90","120","150","180","210","240","269","299","329","359","389","419","449","479","509","539"],[1053.8866,676.7815,392.8929,996.9302,594.2478,507.974,1139.6655,579.7078,934.1587,946.9406,774.4448,865.6055,726.9124,983.6489,804.7397,845.632,709.3489,775.3103,1027.1622,722.1599,503.1301,1025.1892,633.6133,517.7712,1108.7641,571.7162,987.229,950.0426,766.5155,905.1625,816.2491,1097.7538,866.4714,910.6443,638.3879,725.5895,1009.4218,633.6128,332.5626,1014.2059,539.3672,472.3367,1195.5875,564.4037,1016.252,879.7536,718.4646,907.8125,812.6829,1061.9315,796.2194,892.8501,562.6414,827.8593,1089.2723,704.0955,304.5675,1089.4772,653.1073,592.0598,1304.2087,664.9833,1068.0228,1009.6937,851.6733,903.7414,890.8353,1163.2532,970.1837,895.9254,506.1368,734.304,1090.5304,739.3209,592.466,1089.5642,685.918,559.4916,1185.9003,575.5621,1038.3792,997.5589,791.2077,957.1595,859.4904,1111.9505,910.5966,943.0543,749.5163,867.4408,1150.692,656.4582,449.8179,1049.6715,627.7268,503.8572,1233.2753,677.2698,1035.6364,954.2988,778.0865,1006.6036,805.4829,1121.5267,988.3112,937.2274,632.4238,779.1075,1097.3551,671.4843,579.4652,1028.5792,646.827,550.6783,1176.4371,660.9539,992.6642,934.4613,742.5032,911.099,827.1977,1078.6085,895.9185,914.619,652.5142,803.8281,1103.081,718.0599,460.6554,1032.5355,594.6389,518.6391,1259.6865,562.2457,996.2633,961.2831,800.4131,937.8476,853.6622,1052.7072,971.0859,866.2121,544.0553,793.7979,922.5899,709.4098,386.7818,1050.5679,575.0502,497.1411,1221.5307,643.6717,947.0956,740.8071,1006.5718,903.6079,1181.4019,918.3671,909.1477,574.101,815.8738,1054.3164,755.8813,480.8976,1067.3788,621.0092,559.114,1169.668,626.7983,1039.1057,967.0675,838.0475,929.3435,848.5628,1105.3719,898.0492,930.8742,689.1034,864.3331,999.1097,715.1165,438.6576,1046.7004,628.299,558.4185,1224.9927,593.9753,959.6689,917.2466,806.2453,932.49,858.1894,1094.3399,876.907,957.78,444.9161,864.0282,1023.8673,719.3742,468.7252,1098.907,674.5178,654.5293,1243.4191,630.2589,1023.8724,967.954,758.7308,900.8072,832.2861,1138.0755,934.3945,942.6088,705.7516,892.0432,1072.3373,699.6103,470.4842,1027.1579,698.4183,629.3681,1232.3287,646.5887,1057.6889,1005.6961,841.3199,966.6152,897.6806,1037.5935,970.5646,964.3121,648.8251,871.701,1073.4952,686.8034,396.0211,1063.6929,661.0613,535.0826,1256.421,634.8302,1014.3765,985.3576,808.9862,883.3933,843.696,1106.632,928.8835,971.4191,623.1526,840.1954,1114.3559,754.0145,478.112,1060.6085,653.4128,572.2138,1085.9641,605.1138,1012.4136,946.0043,821.4094,899.4805,881.3319,1086.2169,908.6316,903.3281,806.5929,904.2097,1043.8328,759.2007,573.3388,1050.4746,643.7284,558.6211,1188.099,614.9632,1014.219,948.3734,739.0545,940.6905,820.2828,1047.6319,875.6876,887.6357,730.6119,871.6724,1150.1793,656.188,480.9883,1051.9555,576.9626,473.1233,1168.02,607.3712,967.1922,915.9611,771.8106,920.0899,825.1826,1035.035,901.5642,899.1313,712.5504,897.6359,1120.4837,703.4517,497.2202,1058.9769,601.5671,508.4099,1207.8247,650.7281,1039.6131,940.2251,737.8518,934.756,854.0729,1072.9639,973.1285,921.5247,695.5008,881.1877,1042.1305,719.8604,514.9874,1018.1299,679.0853,552.6704,1192.4878,582.8249,1003.7864,984.3321,768.4423,877.6816,869.2046,1076.9676,846.2377,918.5617,640.8117,789.0546,1070.516,738.2938,493.378,1004.628,614.6431,614.8886,1191.4263,642.8286,996.8887,982.9421,801.407,920.3538,885.6995,1058.0462,886.8602,951.0668,767.8935,877.0623,1073.8057,778.2274,602.2978,1078.9502,658.6054,621.7264,1230.8119,640.6095,1042.3362,969.3106,846.6535,924.6471,865.1468,1127.3292,841.3737,956.6295,719.9908,938.5065,1135.814,747.2049,519.962,1075.4783,678.8689,699.2434,1198.6899,639.1128,1056.3319,885.484,719.4737,917.5551,872.3539,1110.5337,861.0811,938.6774,766.1234,879.6305,972.6155,664.9044,383.8976,1073.4808,600.6131,502.8776,1140.5221,664.3466,1011.0129,952.4307,765.929,933.3191,831.6767,1052.0579,862.0759,900.3465,634.5917,860.5608,1036.8819,558.77,120.8962,1021.4083,567.857,336.3792,1263.4354,593.5204,1030.4635,960.9844,811.2826,916.4781,762.5712,1194.919,918.4153,947.1607,380.1739,308.466,1158.0076,723.734,427.7092,1037.6483,676.9301,663.3744,1191.7166,644.5761,1002.6841,997.4638,786.5643,928.4242,823.5368,1064.3609,868.1825,892.5237,520.867,802.7706,1196.3118,733.9405,492.3396,1110.8397,658.7742,534.6352,1271.7048,637.0352,1057.5279,1008.4452,794.1075,980.5933,923.0082,1098.2958,913.2719,949.1393,801.0919,937.5288,1121.9666,718.9529,370.9105,1136.4529,656.9831,646.8497,1243.3817,640.825,1072.1069,988.8428,879.9345,932.9946,851.1055,1129.0753,873.4963,917.0925,633.7478,969.2927,1162.7279,777.7428,588.5714,1089.8134,671.5765,534.6993,1298.547,652.8664,1027.2366,1063.1829,864.3421,879.945,942.0414,1131.4764,989.4233,1016.125,704.1297,977.1305,1226.9275,718.8961,382.0641,1077.37,675.6051,498.5851,1303.2306,708.2002,1068.5965,995.1589,812.0069,1051.4467,774.0045,1214.7085,902.9243,943.8877,427.4289,616.9727,1034.8704,661.4686,533.1019,997.3627,611.8438,567.3719,1214.0636,663.4267,985.3926,860.3931,768.798,862.7084,853.453,1106.2887,888.1779,932.257,664.8417,809.8908],[0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.003,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0022,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.0031,0.0031,0.0021,0.0007,0.0068,0.0006,0.0003,0.0005,0.0072,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0029,0.0031,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0058,0.0005,0.0026,0.0035,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.007,0.0006,0.0003,0.0005,0.0075,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.0032,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0031,0.0018,0.0008,0.0072,0.0006,0.0003,0.0005,0.007,0.0004,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0069,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0026,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0024,0.0031,0.003,0.0015,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0028,0.0024,0.0031,0.0029,0.0021,0.0008,0.0065,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0023,0.003,0.0031,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.0031,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0073,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0023,0.003,0.0032,0.0018,0.0008,0.007,0.0006,0.0003,0.0005,0.0076,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.003,0.0027,0.0024,0.0031,0.003,0.0022,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0029,0.0026,0.0023,0.0015,0.0031,0.0021,0.0008,0.0069,0.0006,0.0003,0.0005,0.0065,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.003,0.0027,0.0024,0.0029,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0055,0.0005,0.0025,0.0034,0.0014,0.0022,0.002,0.003,0.0026,0.0023,0.0031,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0075,0.0009,0.0025,0.0034,0.0014,0.0022,0.0019,0.0029,0.0027,0.0023,0.0031,0.0032,0.0019,0.0008,0.007,0.0006,0.0003,0.0005,0.007,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.0031,0.0027,0.0023,0.0031,0.003,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0035,0.0014,0.0022,0.0022,0.0028,0.0027,0.0023,0.003,0.0031,0.002,0.0008,0.0071,0.0006,0.0003,0.0005,0.0073,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0029,0.0027,0.0023,0.003,0.003,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0077,0.0004,0.0026,0.0034,0.0014,0.0022,0.0021,0.0029,0.0027,0.0024,0.0031,0.0032,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0077,0.0009,0.0025,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0022,0.003,0.0032,0.002,0.0008,0.007,0.0006,0.0003,0.0005,0.0073,0.0005,0.0025,0.0034,0.0014,0.0022,0.0021,0.0027,0.0026,0.0023,0.0031,0.0032,0.002,0.0008,0.0073,0.0006,0.0003,0.0005,0.0078,0.0009,0.0025,0.0034,0.0014,0.0022,0.002,0.0028,0.0027,0.0023,0.0031,0.0031,0.0019,0.0008,0.0073,0.0006,0.0003,0.0005,0.007,0.0009,0.0026,0.0035,0.0014,0.0022,0.0021,0.0028,0.0026,0.0022,0.0029,0.0031,0.0018,0.0008,0.0073,0.0006,0.0003,0.0005,0.0072,0.0009,0.0025,0.0034,0.0014,0.0022,0.0022,0.0031,0.0026,0.0023,0.0015,0.0033,0.0021,0.0008,0.0072,0.0006,0.0003,0.0005,0.0074,0.0009,0.0026,0.0034,0.0014,0.0022,0.0021,0.003,0.0027,0.0023,0.0031,0.0032,0.0021,0.0008,0.0071,0.0006,0.0003,0.0005,0.0076,0.0005,0.0026,0.0034,0.0014,0.0022,0.0021,0.0028,0.0027,0.0023,0.003,0.003,0.0015,0.0008,0.007,0.0006,0.0003],["2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>zone<\/th>\n      <th>location<\/th>\n      <th>yield_lsm<\/th>\n      <th>smith.w.x<\/th>\n      <th>units<\/th>\n      <th>yield<\/th>\n      <th>smith.w.y<\/th>\n      <th>year<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy"},{"extend":"excel","filename":"file"}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"60vh","columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[3,4,6,7]}],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script><p>The BLUEs correlation between <code>H2Cal</code> and <code>asrml</code> is (r = 1)</p>
</div>
<div class="section level2">
<h2 id="blups-comparison">BLUPs comparison<a class="anchor" aria-label="anchor" href="#blups-comparison"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blups.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">blups.asrml</span>, <span class="va">blups.h2cal</span>
                    , by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot(blups.comp$yield, blups.comp$predicted.value)</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">blups.comp</span><span class="op">$</span><span class="va">yield</span>, <span class="va">blups.comp</span><span class="op">$</span><span class="va">predicted.value</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"r ="</span>, <span class="va">rs</span><span class="op">)</span>
<span class="co">## r = 0.9818724</span>

<span class="va">blups.comp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/web_table.html">web_table</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-c772d0314d49a7057bbd" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c772d0314d49a7057bbd">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","Scroller"],"data":[["22455","23286","23524","24054","24521","24984","25512","25965","26362","26742","26777","27110","27125","27130","27543","27546","27548","27590","27592","27593","27599","27600","27605","27609","27669","28128","28209","28949","28950","28954"],[803.0416,829.9464,803.9139,863.9497,869.3613,856.3303,843.4225,839.2455,845.3827,859.0269,838.4568,865.3885,873.3932,854.3928,856.116,849.1157,831.7283,852.3404,843.3664,859.1327,878.9646,866.741,831.1319,798.9066,849.4817,885.1459,873.5456,899.6503,866.7809,836.237],[53.6173,53.619,53.6178,53.6172,53.6283,53.6266,53.6179,53.6278,53.6757,53.6208,53.6183,53.6171,53.617,53.619,53.6158,53.6259,53.6177,53.6293,53.6192,53.6193,53.6167,53.619,53.6281,53.6173,53.6279,53.6185,53.6191,53.625,53.6156,53.6318],["Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable"],[773.0349,792.9172,770.178,819.8608,834.4507,819.5343,809.5808,803.7321,803.7272,821.8891,799.039,828.612,834.5181,816.1793,823.8045,815.6673,803.11,819.8147,805.8034,824.1073,841.8029,832.2422,794.8221,749.0031,811.5516,849.7517,836.3969,861.3521,819.9673,803.1781]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>predicted.value<\/th>\n      <th>std.error<\/th>\n      <th>status<\/th>\n      <th>yield<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy"},{"extend":"excel","filename":"file"}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"60vh","columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[1,2,4]}],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script><p>The BLUPs correlation between <code>H2Cal</code> and <code>asrml</code> is (r = 0.9818724)</p>
</div>
</div>
<div class="section level1">
<h1 id="single-stage-analysis">Single-stage analysis<a class="anchor" aria-label="anchor" href="#single-stage-analysis"></a>
</h1>
<div class="section level2">
<h2 id="asreml-1">asreml<a class="anchor" aria-label="anchor" href="#asreml-1"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">asreml</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"scipen"</span><span class="op">=</span><span class="fl">100</span>,<span class="st">"digits"</span><span class="op">=</span> <span class="fl">4</span> <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.options.html" class="external-link">asreml.options</a></span><span class="op">(</span>maxit<span class="op">=</span><span class="fl">100</span><span class="op">)</span> <span class="co"># Set asreml iteration</span>

<span class="co">##### Fit a single-stage model #####</span>
<span class="co">## incomplete block and replicate location-specific</span>
<span class="co">## location-specifice residual variance</span>

<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/asreml.html" class="external-link">asreml</a></span><span class="op">(</span>fixed       <span class="op">=</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">zone</span>,
              random      <span class="op">=</span> <span class="op">~</span> <span class="va">rep</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/modelFunctions.html" class="external-link">at</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span> <span class="op">+</span> <span class="va">rep</span><span class="op">:</span><span class="va">alpha</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/pkg/asreml/man/modelFunctions.html" class="external-link">at</a></span><span class="op">(</span><span class="va">location</span><span class="op">)</span> <span class="op">+</span> <span class="va">zone</span><span class="op">:</span><span class="va">location</span> <span class="op">+</span> 
                             <span class="va">cultivar</span> <span class="op">+</span> <span class="va">cultivar</span><span class="op">:</span><span class="va">zone</span><span class="op">:</span><span class="va">location</span><span class="op">+</span> <span class="va">cultivar</span><span class="op">:</span><span class="va">zone</span>,
              residual    <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/modelFunctions.html" class="external-link">dsum</a></span><span class="op">(</span><span class="op">~</span><span class="op">(</span><span class="va">units</span><span class="op">)</span><span class="op">|</span><span class="va">location</span><span class="op">)</span>,
              data        <span class="op">=</span> <span class="va">fb</span>,
              predict     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/predict.asreml.html" class="external-link">predict.asreml</a></span><span class="op">(</span>classify <span class="op">=</span> <span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/asreml/man/update.asreml.html" class="external-link">update.asreml</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>

<span class="va">blups.asreml</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">predictions</span><span class="op">$</span><span class="va">pvals</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
</div>
<div class="section level2">
<h2 id="h2cal-1">H2cal<a class="anchor" aria-label="anchor" href="#h2cal-1"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inkaverse.com/">inti</a></span><span class="op">)</span>

<span class="va">model</span> <span class="op">&lt;-</span> <span class="va">fb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="../../reference/H2cal.html">H2cal</a></span><span class="op">(</span>trait <span class="op">=</span> <span class="st">"yield"</span>
        , gen.name <span class="op">=</span> <span class="st">"cultivar"</span>
        , env.name <span class="op">=</span> <span class="st">"location"</span>
        , rep.n <span class="op">=</span> <span class="fl">2</span>
        , env.n <span class="op">=</span> <span class="fl">18</span>
        , fixed.model <span class="op">=</span> <span class="st">"0 + zone + (1|rep:location) + (1|rep:alpha:location) + (1|zone:location) + (1|cultivar:zone) + (1|cultivar:zone:location) + cultivar"</span>
        , random.model <span class="op">=</span> <span class="st">"1 + zone + (1|rep:location) + (1|rep:alpha:location) + (1|zone:location) + (1|cultivar:zone) + (1|cultivar:zone:location) + (1|cultivar)"</span>
        , summary <span class="op">=</span> <span class="cn">T</span>
        , emmeans <span class="op">=</span> <span class="cn">T</span>
        <span class="co"># , plot_diag = T</span>
        <span class="op">)</span>
<span class="co">## Linear mixed model fit by REML ['lmerMod']</span>
<span class="co">## Formula: yield ~ 1 + zone + (1 | rep:location) + (1 | rep:alpha:location) +  </span>
<span class="co">##     (1 | zone:location) + (1 | cultivar:zone) + (1 | cultivar:zone:location) +  </span>
<span class="co">##     (1 | cultivar)</span>
<span class="co">##    Data: dt.rm</span>
<span class="co">## Weights: weights</span>
<span class="co">## </span>
<span class="co">## REML criterion at convergence: 11933.2</span>
<span class="co">## </span>
<span class="co">## Scaled residuals: </span>
<span class="co">##     Min      1Q  Median      3Q     Max </span>
<span class="co">## -5.0760 -0.3308 -0.0084  0.3698  4.0576 </span>
<span class="co">## </span>
<span class="co">## Random effects:</span>
<span class="co">##  Groups                 Name        Variance Std.Dev.</span>
<span class="co">##  cultivar:zone:location (Intercept)  2209.5   47.00  </span>
<span class="co">##  rep:alpha:location     (Intercept)   944.6   30.73  </span>
<span class="co">##  cultivar:zone          (Intercept)   129.6   11.38  </span>
<span class="co">##  rep:location           (Intercept)   334.0   18.28  </span>
<span class="co">##  cultivar               (Intercept)   728.0   26.98  </span>
<span class="co">##  zone:location          (Intercept) 48679.8  220.64  </span>
<span class="co">##  Residual                            1396.8   37.37  </span>
<span class="co">## Number of obs: 1069, groups:  </span>
<span class="co">## cultivar:zone:location, 539; rep:alpha:location, 251; cultivar:zone, 90; rep:location, 36; cultivar, 30; zone:location, 18</span>
<span class="co">## </span>
<span class="co">## Fixed effects:</span>
<span class="co">##             Estimate Std. Error t value</span>
<span class="co">## (Intercept)   813.35      83.85   9.700</span>
<span class="co">## zonenorth      51.57     129.67   0.398</span>
<span class="co">## zonesouth      59.75     123.21   0.485</span>
<span class="co">## </span>
<span class="co">## Correlation of Fixed Effects:</span>
<span class="co">##           (Intr) znnrth</span>
<span class="co">## zonenorth -0.644       </span>
<span class="co">## zonesouth -0.678  0.439</span>

<span class="va">blups.h2cal</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">blups</span> </code></pre></div>
</div>
<div class="section level2">
<h2 id="blups-comparison-1">BLUPs comparison<a class="anchor" aria-label="anchor" href="#blups-comparison-1"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">blups.comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">blups.asreml</span>, <span class="va">blups.h2cal</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cultivar"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot(blups.comp$predicted.value, blups.comp$yield)</span>
<span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/asreml/man/unstructured.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">blups.comp</span><span class="op">$</span><span class="va">predicted.value</span>, <span class="va">blups.comp</span><span class="op">$</span><span class="va">yield</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"r ="</span>, <span class="va">rs</span><span class="op">)</span>
<span class="co">## r = 0.9201732</span>

<span class="va">blups.comp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../../reference/web_table.html">web_table</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-50e0e14e3fbb012dbdbe" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-50e0e14e3fbb012dbdbe">{"x":{"filter":"none","vertical":false,"extensions":["Buttons","Scroller"],"data":[["22455","23286","23524","24054","24521","24984","25512","25965","26362","26742","26777","27110","27125","27130","27543","27546","27548","27590","27592","27593","27599","27600","27605","27609","27669","28128","28209","28949","28950","28954"],[799.6062,829.2253,804.4229,871.042,868.3307,855.0887,839.1676,840.7004,849.6037,859.6556,842.7738,863.9857,875.5788,856.7206,851.0877,842.821,826.2886,849.085,844.0249,856.6981,873.8515,862.3616,831.3956,814.917,853.4611,884.0226,874.3242,898.7078,877.4787,831.2612],[53.4514,53.454,53.4522,53.4502,53.4586,53.4566,53.4506,53.4559,53.5022,53.4513,53.4522,53.4502,53.4507,53.4513,53.4498,53.4627,53.4526,53.4595,53.4534,53.4532,53.4518,53.4528,53.4576,53.4512,53.4569,53.4519,53.4534,53.4608,53.4496,53.4584],["Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable","Estimable"],[774.2085,793.3491,768.1799,821.6019,832.9218,820.0897,807.9516,801.2365,802.3588,823.093,797.5399,829.5655,832.3283,814.9198,824.0008,814.7511,802.124,817.5921,803.8942,824.6404,841.4552,832.5808,795.3311,746.9311,812.5252,849.1321,836.6204,859.9027,819.0341,800.7321]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cultivar<\/th>\n      <th>predicted.value<\/th>\n      <th>std.error<\/th>\n      <th>status<\/th>\n      <th>yield<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bt","buttons":[{"extend":"copy"},{"extend":"excel","filename":"file"}],"deferRender":true,"scroller":true,"scrollX":true,"scrollY":"60vh","columnDefs":[{"width":"200px","targets":"_all"},{"className":"dt-right","targets":[1,2,4]}],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#000', 'color': '#fff'});\n}","order":[],"autoWidth":false,"orderClasses":false}},"evals":["options.initComplete"],"jsHooks":[]}</script><p>The BLUPs correlation between <code>H2Cal</code> and <code>asrml</code> is (r = 0.9201732)</p>
</div>
</div>
<div class="section level1">
<h1 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-buntaran2020Cross" class="csl-entry">
Buntaran, H., H.-P. Piepho, P. Schmidt, J. Rydén, M. Halling, et al. 2020. Cross-validation of stagewise mixed-model analysis of <span>Swedish</span> variety trials with winter wheat and spring barley. Crop Science 60(5): 2221–2240. doi: <a href="https://doi.org/10.1002/csc2.20177" class="external-link">10.1002/csc2.20177</a>.
</div>
<div id="ref-R-inti" class="csl-entry">
Lozano-Isla, F. 2020. <a href="https://lozanoisla.com/" class="external-link">Inti: Tools and statistical procedures in plant science</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Desarrollado por <a href="https://lozanoisla.com/" class="external-link">Flavio Lozano-Isla</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
